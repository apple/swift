// RUN: %target-sil-opt %s

import Swift
import Builtin

class C {}

sil @test : $@convention(thin) <U where U : AnyObject> (@inout U) -> () {
bb0(%0 : $*U):
  %1 = load [copy] %0 : $*U
  %2 = ref_to_unmanaged %1 : $U to $@sil_unmanaged U
  %3 = unmanaged_to_ref %2 : $@sil_unmanaged U to $U
  destroy_value %1 : $U
  %9999 = tuple ()
  return %9999 : $()
}

sil @retain_release : $@convention(thin) (@sil_unmanaged C) -> () {
bb0(%0 : $@sil_unmanaged C):
  %1 = unmanaged_to_ref %0 : $@sil_unmanaged C to $C
  unmanaged_retain_value %1 : $C
  unmanaged_autorelease_value %1 : $C
  unmanaged_release_value %1 : $C
  %9999 = tuple()
  return %9999 : $()
}
