# REQUIRES: standalone_build

# RUN: %empty-directory(%t)
# RUN: mkdir -p %t/build
# RUN: mkdir -p %t/source
# RUN: split-file %s %t/source
# RUN: %{cmake-generate} -DSWIFT_TOOLS_ENABLE_LTO="thin" -DCMAKE_MODULE_PATH=%swift_src_root/cmake/modules -S %t/source -B %t/build | %FileCheck --check-prefix=CHECK-THIN %s

# CHECK-THIN: COMPILE_OPTIONS
# CHECK-THIN-SAME: -flto=thin
# CHECK-THIN: LINK_OPTIONS
# CHECK-THIN-SAME: -flto=thin

# RUN: %{cmake-generate} -DSWIFT_TOOLS_ENABLE_LTO="full" -DCMAKE_MODULE_PATH=%swift_src_root/cmake/modules -S %t/source -B %t/build | %FileCheck --check-prefix=CHECK-FULL %s

# CHECK-FULL: COMPILE_OPTIONS
# CHECK-FULL-SAME: -flto=full
# CHECK-FULL: LINK_OPTIONS
# CHECK-FULL-SAME: -flto=full

# RUN: %{cmake-generate} -DSWIFT_TOOLS_ENABLE_LTO="" -DCMAKE_MODULE_PATH=%swift_src_root/cmake/modules -S %t/source -B %t/build | %FileCheck %s

# CHECK-NOT: COMPILE_OPTIONS {{.*}}-flto=
# CHECK-NOT: LINK_OPTIONS {{.*}}-flto=

#--- CMakeLists.txt
cmake_minimum_required(VERSION 3.12.4)

project(character)

include(AddSwift)

add_executable(placeholder hello.c)

add_lto_flags(placeholder)

get_target_property(placeholder_compile_options placeholder COMPILE_OPTIONS)
message(STATUS "COMPILE_OPTIONS ${placeholder_compile_options}")
get_target_property(placeholder_link_options placeholder LINK_OPTIONS)
message(STATUS "LINK_OPTIONS ${placeholder_link_options}")

#--- hello.c
int main(){}
