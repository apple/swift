# REQUIRES: standalone_build
# REQUIRES: OS=macosx

# Ensure the CMake variable is properly unset when building our own overlays
# RUN: %empty-directory(%t)
# RUN: SWIFT_BUILD_ROOT=%t %swift_src_root/utils/build-script --dry-run --cmake %cmake  2>&1 | %FileCheck --check-prefix=OPTION-OFF-CHECK %s

# RUN: %empty-directory(%t)
# RUN: SWIFT_BUILD_ROOT=%t %swift_src_root/utils/build-script --dry-run --darwin-overlays-from-sdks=0 --cmake %cmake  2>&1 | %FileCheck --check-prefix=OPTION-OFF-CHECK %s

# OPTION-OFF-CHECK-NOT: -DSWIFT_OVERLAY_TARGETS
# OPTION-OFF-CHECK: -USWIFT_OVERLAY_TARGETS


# Ensure the CMake variable is properly set when we want to pick up overlays from the SDKs
# RUN: %empty-directory(%t)
# RUN: SWIFT_BUILD_ROOT=%t %swift_src_root/utils/build-script --dry-run --darwin-overlays-from-sdks=1 --cmake %cmake  2>&1 | %FileCheck --check-prefix=OPTION-ON-CHECK %s

# RUN: %empty-directory(%t)
# RUN: SWIFT_BUILD_ROOT=%t %swift_src_root/utils/build-script --dry-run --darwin-overlays-from-sdks --cmake %cmake  2>&1 | %FileCheck --check-prefix=OPTION-ON-CHECK %s

# OPTION-ON-CHECK: -DSWIFT_OVERLAY_TARGETS:STRING={{ |$}}
# OPTION-ON-CHECK-NOT: -USWIFT_OVERLAY_TARGETS
